
<div class="index-container">
  <span id="tagline">
  <h5>Find Public Art Near You</h5>
  </span>
  <div class="index-spacer"></div>
  <div class ="content-box">
  <div id='map'>
  </div>

    <div class="listings-container">
    <div class="listings">
    {{#each arts}}
    <div class="artist-div">
    <div class="art-info">
    <a href="/artists/{{_id}}"><h5>Artist: {{this.artist}}</a>
    <br>Title: {{this.title}}
    <br>Year: {{this.year}}
    <br>Posted By: {{this.postedBy}}
    </h5>
    </div>
    <div class="art-info-img">
      <img src={{this.imgPath}} />
    </div>
    </div>
    {{/each}}
    </div>
    </div>
  </div>
  </div>
</div>
<div class="add-art">
  <h3><a href="/auth/add/">Add An Artwork</a></h3>
</div>


<script>
mapboxgl.accessToken = 'pk.eyJ1IjoicHJlc2VudG1vbWVudCIsImEiOiJjanhpdGlhczkwNWdpM3dwbHRtMGVrdWYwIn0.xzwCmqIxkr_AfZ3YNBwy9g';
var map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/mapbox/outdoors-v9',
});
map.setZoom(3);
map.setCenter([13, 52]);
var mapNav = new mapboxgl.NavigationControl();
map.addControl(mapNav, 'bottom-right');
map.addControl(new mapboxgl.GeolocateControl({
    positionOptions: {
        enableHighAccuracy: true
    },
    trackUserLocation: true
}));

axios.get('http://localhost:3000/api/material').then(response => {
  console.log(response.data)
  const artwork = response.data;

  artwork.forEach(artwork => {
    const coordinates = artwork.location.coordinates.reverse();

    let popup = new mapboxgl.Popup({ offset: 0, className: 'my-class' })
        .setHTML(`<div class="popup"><img height="50px" src="${artwork.imgPath}" alt=""><p>${artwork.title} by ${artwork.artist}</p></div>`)
        .setMaxWidth("none")

    let marker = new mapboxgl.Marker().setLngLat(coordinates).setPopup(popup).addTo(map);
  })

}).catch(err => {
    console.log(err)
})
</script>